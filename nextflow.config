// enable DSL2
nextflow.enable.dsl=2

/* quick test:

    nextflow run main.nf   --samples "test_samples/*.fasta"   --outdir "results_test"

*/

// Parameters
params {
    // samples and outdir must be provided via CLI
    reference_fasta    = "raw_data/NC_045512.2_sequence.fasta"
    train_feature_matrix = "lasso_training_data/feature_matrix_train.csv"
    model              = "model_artifacts/lasso_model.joblib"
    scaler             = "model_artifacts/scaler.joblib"
    chunk_size         = 10
    identity_thresh    = 92.0
}

process {
    executor = 'local'
    maxForks = 10    // default to 10 parallel forks
}

// Enable conda/mamba support
conda {
    enabled = true
    useMamba = true
}

profiles {
    standard {
        conda.enabled = true
        conda.useMamba = true
    }

    aws {
        process {
            executor = 'awsbatch'
            // maybe bump forks up for AWS
            maxForks = 50
        }
        conda.enabled = true
        conda.useMamba = true
    }
}